-- Remake by AcxTheScripter 

local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

-- ===== CONFIG =====
local HISTORY_SIZE = 120
local SMOOTHING_ALPHA = 0.12
local GRAPH_BAR_WIDTH = 3
local GRAPH_BAR_SPACING = 1
local GRAPH_MAX_HEIGHT = 50
local START_VISIBLE = true
local TOGGLE_KEY = Enum.KeyCode.F
local THEME_ACCENT = Color3.fromRGB(200,30,30)
local TEXT_COLOR = Color3.fromRGB(240,240,240)
-- ==================

local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "FPSCheckerGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

-- Main Frame
local mainFrame = Instance.new("Frame")
mainFrame.Name = "Main"
mainFrame.Size = UDim2.new(0, 230, 0, 110)
mainFrame.Position = UDim2.new(0, 20, 0, 80)
mainFrame.BackgroundTransparency = 1
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui
mainFrame.Visible = START_VISIBLE
mainFrame.Active = true
mainFrame.ZIndex = 2
Instance.new("UICorner", mainFrame).CornerRadius = UDim.new(0,8)

-- Title
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -8, 0, 24)
title.Position = UDim2.new(0, 4, 0, 4)
title.BackgroundTransparency = 1
title.Text = "FPS Checker"
title.TextColor3 = TEXT_COLOR
title.Font = Enum.Font.GothamBold
title.TextSize = 14
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = mainFrame

-- Toggle button
local toggleBtn = Instance.new("TextButton")
toggleBtn.Name = "ToggleBtn"
toggleBtn.Size = UDim2.new(0, 36, 0, 20)
toggleBtn.Position = UDim2.new(1, -40, 0, 6)
toggleBtn.BackgroundColor3 = THEME_ACCENT
toggleBtn.TextColor3 = TEXT_COLOR
toggleBtn.Font = Enum.Font.Gotham
toggleBtn.TextSize = 12
toggleBtn.Text = (mainFrame.Visible and "Hide" or "Show")
toggleBtn.Parent = mainFrame
Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(0,6)

-- FPS label
local fpsLabel = Instance.new("TextLabel")
fpsLabel.Size = UDim2.new(1, -8, 0, 34)
fpsLabel.Position = UDim2.new(0, 4, 0, 30)
fpsLabel.BackgroundTransparency = 1
fpsLabel.TextColor3 = TEXT_COLOR
fpsLabel.Font = Enum.Font.GothamBold
fpsLabel.TextSize = 20
fpsLabel.Text = "FPS: 0"
fpsLabel.TextXAlignment = Enum.TextXAlignment.Left
fpsLabel.Parent = mainFrame

-- Stats label (moved further down)
local statsLabel = Instance.new("TextLabel")
statsLabel.Size = UDim2.new(1, -8, 0, 30)
statsLabel.Position = UDim2.new(0, 4, 0, 70) -- 65 â†’ 70 (binaba pa)
statsLabel.BackgroundTransparency = 1
statsLabel.TextColor3 = TEXT_COLOR
statsLabel.Font = Enum.Font.Gotham
statsLabel.TextSize = 13
statsLabel.Text = "ms: 0.00   Avg: 0.00   Min: 0.00   Max: 0.00"
statsLabel.TextXAlignment = Enum.TextXAlignment.Left
statsLabel.Parent = mainFrame

-- Subtle credit text
local creditLabel = Instance.new("TextLabel")
creditLabel.Size = UDim2.new(1, -8, 0, 14)
creditLabel.Position = UDim2.new(0, 4, 1, -16)
creditLabel.BackgroundTransparency = 1
creditLabel.Text = "Remake by AcxScripter"
creditLabel.TextColor3 = Color3.fromRGB(180,180,180)
creditLabel.Font = Enum.Font.Gotham
creditLabel.TextSize = 10
creditLabel.TextXAlignment = Enum.TextXAlignment.Right
creditLabel.Parent = mainFrame

-- Graph container
local graphContainer = Instance.new("Frame")
graphContainer.Size = UDim2.new(1, -12, 0, GRAPH_MAX_HEIGHT+6)
graphContainer.Position = UDim2.new(0, 6, 1, -GRAPH_MAX_HEIGHT-10)
graphContainer.BackgroundTransparency = 1
graphContainer.Parent = mainFrame

local barHolder = Instance.new("Frame")
barHolder.Size = UDim2.new(1, 0, 1, 0)
barHolder.BackgroundTransparency = 1
barHolder.Parent = graphContainer
barHolder.ClipsDescendants = true

local bars = {}
for i = 1, HISTORY_SIZE do
	local b = Instance.new("Frame")
	b.Size = UDim2.new(0, GRAPH_BAR_WIDTH, 0, 2)
	b.Position = UDim2.new(0, (i-1)*(GRAPH_BAR_WIDTH + GRAPH_BAR_SPACING), 1, -2)
	b.AnchorPoint = Vector2.new(0,1)
	b.BackgroundColor3 = THEME_ACCENT
	b.BorderSizePixel = 0
	b.Parent = barHolder
	bars[i] = b
end

-- Mobile FPS toggle button (upper-right)
local mobileBtn = Instance.new("TextButton")
mobileBtn.Name = "MobileToggle"
mobileBtn.Size = UDim2.new(0, 44, 0, 44)
mobileBtn.Position = UDim2.new(1, -60, 0, 40)
mobileBtn.AnchorPoint = Vector2.new(0,0)
mobileBtn.BackgroundColor3 = THEME_ACCENT
mobileBtn.TextColor3 = Color3.new(1,1,1)
mobileBtn.Font = Enum.Font.GothamBold
mobileBtn.TextSize = 16
mobileBtn.Text = "FPS"
mobileBtn.AutoButtonColor = true
mobileBtn.Parent = screenGui
Instance.new("UICorner", mobileBtn).CornerRadius = UDim.new(1,0)

-- ===== FPS logic =====
local history, sumForAvg, displayedFPS = {}, 0, 0
for i = 1, HISTORY_SIZE do
	history[i] = 60
	sumForAvg += 60
end

local function pushHistory(val)
	sumForAvg -= history[1]
	table.remove(history,1)
	table.insert(history,val)
	sumForAvg += val
end

local function computeStats()
	local minv, maxv = math.huge, 0
	for _,v in ipairs(history) do
		if v < minv then minv = v end
		if v > maxv then maxv = v end
	end
	return sumForAvg / #history, minv, maxv
end

local function updateGraph()
	local cap = 120
	for i,bar in ipairs(bars) do
		local v = history[i] or 0
		local h = math.clamp((v / cap) * GRAPH_MAX_HEIGHT, 2, GRAPH_MAX_HEIGHT)
		bar:TweenSizeAndPosition(
			UDim2.new(0, GRAPH_BAR_WIDTH, 0, h),
			UDim2.new(0, (i-1)*(GRAPH_BAR_WIDTH + GRAPH_BAR_SPACING), 1, -h),
			Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.08, true
		)
		local t = math.clamp(v / 60, 0, 1)
		bar.BackgroundColor3 = Color3.new(1 - (1-t)*0.6, t*0.95, t*0.2)
	end
end

RunService.Heartbeat:Connect(function(dt)
	local fps = (dt > 0) and (1/dt) or 0
	pushHistory(fps)
	displayedFPS += (fps - displayedFPS) * SMOOTHING_ALPHA
	local avg, minv, maxv = computeStats()
	fpsLabel.Text = string.format("FPS: %d", math.floor(displayedFPS + 0.5))
	statsLabel.Text = string.format("ms: %.2f   Avg: %.1f   Min: %.1f   Max: %.1f", 1000 / math.max(displayedFPS,0.0001), avg, minv, maxv)
	updateGraph()
end)

-- ===== Interactions =====
toggleBtn.MouseButton1Click:Connect(function()
	mainFrame.Visible = not mainFrame.Visible
	toggleBtn.Text = (mainFrame.Visible and "Hide" or "Show")
end)

mobileBtn.MouseButton1Click:Connect(function()
	mainFrame.Visible = not mainFrame.Visible
	toggleBtn.Text = (mainFrame.Visible and "Hide" or "Show")
	TweenService:Create(mobileBtn, TweenInfo.new(0.12), {BackgroundTransparency = 0.2}):Play()
	task.delay(0.12, function()
		TweenService:Create(mobileBtn, TweenInfo.new(0.12), {BackgroundTransparency = 0}):Play()
	end)
end)

UserInputService.InputBegan:Connect(function(input, gp)
	if gp then return end
	if input.UserInputType == Enum.UserInputType.Keyboard and input.KeyCode == TOGGLE_KEY then
		mainFrame.Visible = not mainFrame.Visible
		toggleBtn.Text = (mainFrame.Visible and "Hide" or "Show")
	end
end)

-- ===== Draggable functionality for mainFrame =====
local dragging, dragInput, dragStart, startPos = false, nil, nil, nil
local function updateDrag(input)
	local delta = input.Position - dragStart
	mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

mainFrame.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = input.Position
		startPos = mainFrame.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then dragging = false end
		end)
	end
end)

mainFrame.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
		dragInput = input
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if input == dragInput and dragging then updateDrag(input) end
end)

-- ===== Draggable functionality for mobile =====
local mobileDragging, mobileDragInput, mobileDragStart, mobileStartPos = false, nil, nil, nil
local function updateMobileDrag(input)
	local delta = input.Position - mobileDragStart
	mobileBtn.Position = UDim2.new(mobileStartPos.X.Scale, mobileStartPos.X.Offset + delta.X, mobileStartPos.Y.Scale, mobileStartPos.Y.Offset + delta.Y)
end

mobileBtn.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		mobileDragging = true
		mobileDragStart = input.Position
		mobileStartPos = mobileBtn.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then mobileDragging = false end
		end)
	end
end)

mobileBtn.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
		mobileDragInput = input
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if input == mobileDragInput and mobileDragging then updateMobileDrag(input) end
end)

-- initial graph draw
updateGraph()
